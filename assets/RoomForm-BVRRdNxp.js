import{_ as X,p as D,i as J,r as p,w as _,c as d,b as r,d as e,l as u,f as i,e as y,v as k,g as N,m as v,q as K,F as Y,x as ee,n as te,y as se}from"./index-SdmsmDou.js";function ot(){function m(o){return`editCode:${o}`}function S(o,w){sessionStorage.setItem(m(o),w)}function x(o){return sessionStorage.getItem(m(o))}function I(o){sessionStorage.removeItem(m(o))}return{saveEditCode:S,getEditCode:x,clearEditCode:I}}const oe={class:"room-form"},le={class:"row"},ae={class:"field"},ie={key:0,class:"error"},ne={class:"row"},de={class:"field"},re={key:0,class:"error"},ue={class:"row"},ce={class:"field color-field"},pe={class:"color-wrapper"},ve={class:"row"},me={class:"field"},fe=["value"],he={class:"row"},ge={class:"field"},we={class:"size-value"},Ce=["value"],be={class:"row"},_e={class:"field"},ye=["value"],ke={class:"row"},Se={class:"field"},xe={class:"swatches"},Ie=["title","onClick"],Pe={key:0,class:"popover"},Te={align:"center"},Re={class:"color-wrapper"},Ae={key:1,class:"popover"},Me={class:"popover-actions"},Fe={key:0,class:"error"},Ee={class:"row"},De={class:"field sprite-field"},Ne={key:0,class:"preview"},Ve=["src"],$e={class:"sprite-actions"},Ue=["disabled"],ze={class:"row"},Be={class:"field"},He={class:"size-value"},Oe=["value"],Le={class:"row"},Ge={class:"field switch-field"},je={class:"switch"},qe=["checked"],We={class:"row"},Ze={class:"field"},Qe={class:"size-value"},Xe=["value"],Je={class:"row"},Ke={class:"field"},Ye={class:"size-value"},et=["value"],tt={__name:"RoomForm",props:{modelValue:{type:Object,required:!0},mode:{type:String,default:"edit"}},emits:["update:modelValue"],setup(m,{emit:S}){const x=m,I=S,o=D({get(){return x.modelValue},set(s){I("update:modelValue",s)}}),w=/^#[0-9A-Fa-f]{6}$/,V=/^[0-9a-zA-Z,.! ]+$/,$=/^[0-9A-Za-z ,.!\-_=+@#$%^&*(){}\[\]|\\:;"'<>,.?/~`]+$/;function A(s){return s===""||typeof s=="string"&&s.length<=64&&V.test(s)}function M(s){return s===""||typeof s=="string"&&s.length<=64&&$.test(s)}const n=J({name:"",password:"",penColors:""}),f=p(o.value.name??""),h=p(o.value.password??"");_(()=>o.value.name,s=>{s!==f.value&&A(s??"")&&(f.value=s??"")}),_(()=>o.value.password,s=>{s!==h.value&&M(s??"")&&(h.value=s??"")}),_(f,s=>{A(s)?(n.name="",o.value.name=s):n.name="Only 0-9 a-z A-Z , . ! and space; max 64 chars"}),_(h,s=>{M(s)?(n.password="",o.value.password=s):n.password="Invalid characters or length > 64"});const F=D({get(){const s=o.value.themeColor||"";return s?`#${s}`:"#000000"},set(s){const t=(s||"").trim();w.test(t)&&(o.value.themeColor=t.slice(1).toUpperCase())}});function U(s){["hidden","top-left","top-right","bottom-left","bottom-right"].includes(s)&&(o.value.showCode=s)}const C=p(!1),P=p(null),c=p(-1),b=p("#000000");function z(){c.value=-1,b.value="#000000",C.value=!0,te(()=>P.value&&P.value.focus())}function B(){const s=b.value;if(w.test(s)){const t=s.slice(1).toUpperCase();o.value.penColors.includes(t)||o.value.penColors.push(t),n.penColors=""}else n.penColors="Pick a 6-digit hex color";C.value=!1}function H(){C.value=!1}function O(s){c.value=c.value===s?-1:s}function L(s){o.value.penColors.splice(s,1),c.value=-1}const T=p(null);async function G(s){const t=s.target.files&&s.target.files[0];if(!t||t.type!=="image/png")return;const l=await q(t),a=await W(l,256);a&&(o.value.penlightSprite=a)}function j(){o.value.penlightSprite=null,T.value&&(T.value.value="")}function q(s){return new Promise((t,l)=>{const a=new FileReader;a.onload=()=>t(a.result),a.onerror=l,a.readAsDataURL(s)})}function W(s,t=256){return new Promise(l=>{const a=new Image;a.onload=()=>{const g=document.createElement("canvas");g.width=t,g.height=t;const R=g.getContext("2d");R.clearRect(0,0,t,t);const E=Math.min(t/a.width,t/a.height);Math.round(a.width*E),Math.round(a.height*E),R.imageSmoothingEnabled=!0,R.imageSmoothingQuality="high",l(g.toDataURL("image/png"))},a.onerror=()=>l(null),a.src=s})}function Z(s){o.value.penTrails=!!s}function Q(s){const t=Number(s);Number.isFinite(t)&&(o.value.maxConcurrent=Math.max(1,Math.trunc(t)))}return(s,t)=>(r(),d("div",oe,[t[33]||(t[33]=e("div",{class:"row-header"},"General Room Settings",-1)),e("div",le,[t[16]||(t[16]=e("div",{class:"label",for:"name"},[i(" Name "),e("div",{class:"desc"},"(optional)")],-1)),e("div",ae,[y(e("input",{id:"name",type:"text",maxlength:64,"onUpdate:modelValue":t[0]||(t[0]=l=>f.value=l),placeholder:"(optional)",class:N({invalid:!!n.name})},null,2),[[k,f.value]]),n.name?(r(),d("p",ie,v(n.name),1)):u("",!0)])]),e("div",ne,[t[17]||(t[17]=e("div",{class:"label",for:"password"},[i(" Password "),e("div",{class:"desc"},"optional - to make private room")],-1)),e("div",de,[y(e("input",{id:"password",type:"text",maxlength:64,"onUpdate:modelValue":t[1]||(t[1]=l=>h.value=l),placeholder:"(optional)",class:N({invalid:!!n.password})},null,2),[[k,h.value]]),n.password?(r(),d("p",re,v(n.password),1)):u("",!0)])]),t[34]||(t[34]=e("div",{class:"row-header"},"OBS Display:",-1)),e("div",ue,[t[18]||(t[18]=e("div",{class:"label",for:"themeColor"},[i(" Theme Color "),e("div",{class:"desc"},"Used for name text & Code text")],-1)),e("div",ce,[e("div",pe,[y(e("input",{id:"themeColor",type:"color","onUpdate:modelValue":t[2]||(t[2]=l=>F.value=l),"aria-label":"Pick a theme color"},null,512),[[k,F.value]])]),u("",!0)])]),e("div",ve,[t[20]||(t[20]=e("div",{class:"label",for:"showCode"},[i(" Show Code "),e("div",{class:"desc"},"Where to show the Code in the OBS source")],-1)),e("div",me,[e("select",{id:"showCode",value:o.value.showCode,onChange:t[3]||(t[3]=l=>U(l.target.value))},[...t[19]||(t[19]=[K('<option value="hidden" data-v-734bf1a5>Hidden</option><option value="top-left" data-v-734bf1a5>Top Left</option><option value="top-right" data-v-734bf1a5>Top Right</option><option value="bottom-left" data-v-734bf1a5>Bottom Left</option><option value="bottom-right" data-v-734bf1a5>Bottom Right</option>',5)])],40,fe)])]),e("div",he,[t[21]||(t[21]=e("div",{class:"label",for:"showCode"},[i(" Code Size "),e("div",{class:"desc"},"Adjust the scale of the code")],-1)),e("div",ge,[e("div",we,v(o.value.showCodeScale.toFixed(1))+"×",1),e("input",{id:"showCodeScale",class:"slider",type:"range",min:"0.1",max:"5",step:"0.1",value:o.value.showCodeScale,onInput:t[4]||(t[4]=l=>o.value.showCodeScale=Math.max(.1,Math.min(5,parseFloat(l.target.value)||1)))},null,40,Ce)])]),e("div",be,[t[22]||(t[22]=e("div",{class:"label",for:"maxConc"},[i(" Max Concurrent "),e("div",{class:"desc"},"How many users to render in OBS")],-1)),e("div",_e,[e("input",{id:"maxConc",type:"number",min:"1",value:o.value.maxConcurrent,onInput:t[5]||(t[5]=l=>Q(l.target.value))},null,40,ye)])]),t[35]||(t[35]=e("div",{class:"row-header"},"Pen Lights:",-1)),e("div",ke,[t[23]||(t[23]=e("div",{class:"label"},[i(" Pen Colors "),e("div",{class:"desc"},"Add colors for chatters to pick for their pen."),e("div",{class:"desc"},"Or, leave empty and theme color will be used.")],-1)),e("div",Se,[e("div",xe,[(r(!0),d(Y,null,ee(o.value.penColors,(l,a)=>(r(),d("button",{key:a,type:"button",class:"swatch",style:se({backgroundColor:"#"+l}),title:"#"+l,onClick:g=>O(a)},null,12,Ie))),128)),e("button",{type:"button",class:"add",onClick:z,title:"Add color"},"+"),C.value?(r(),d("div",Pe,[e("div",Te,[e("div",{class:"popover-actions"},[e("button",{type:"button",onClick:B},"Confirm"),e("button",{type:"button",class:"ghost",onClick:H},"Cancel")]),e("div",Re,[y(e("input",{ref_key:"addPickerRef",ref:P,type:"color","onUpdate:modelValue":t[6]||(t[6]=l=>b.value=l)},null,512),[[k,b.value]])])])])):u("",!0),c.value>=0?(r(),d("div",Ae,[e("div",Me,[e("button",{type:"button",class:"danger",onClick:t[7]||(t[7]=l=>L(c.value))},"Delete"),e("button",{type:"button",class:"ghost",onClick:t[8]||(t[8]=l=>c.value=-1)},"Close")])])):u("",!0)]),n.penColors?(r(),d("p",Fe,v(n.penColors),1)):u("",!0)])]),e("div",Ee,[t[24]||(t[24]=e("div",{class:"label"},[i(" Penlight Sprite "),e("div",{class:"desc"},[i(" Optional PNG to show as base penlight in OBS. "),e("br"),i(" Will be resized to 256×256. ")])],-1)),e("div",De,[o.value.penlightSprite?(r(),d("div",Ne,[e("img",{src:o.value.penlightSprite,alt:"Sprite preview"},null,8,Ve)])):u("",!0),e("div",$e,[e("input",{id:"sprite-file-input",ref_key:"fileInputRef",ref:T,type:"file",accept:"image/png",class:"file-input sr-only",onChange:G,"aria-label":"Choose a PNG sprite"},null,544),e("button",{type:"button",class:"btn btn-primary",onClick:t[9]||(t[9]=l=>s.$refs.fileInputRef&&s.$refs.fileInputRef.click())}," Choose File "),e("button",{type:"button",class:"btn btn-ghost",disabled:!o.value.penlightSprite,onClick:j}," Clear Image ",8,Ue)])])]),e("div",ze,[t[25]||(t[25]=e("div",{class:"label",for:"showCode"},[i(" Pen Size "),e("div",{class:"desc"},"Adjust the scale of the lights")],-1)),e("div",Be,[e("div",He,v(o.value.penScale.toFixed(1))+"×",1),e("input",{id:"penScale",class:"slider",type:"range",min:"0.1",max:"2",step:"0.1",value:o.value.penScale,onInput:t[10]||(t[10]=l=>o.value.penScale=Math.max(.1,Math.min(5,parseFloat(l.target.value)||1)))},null,40,Oe)])]),e("div",Le,[t[27]||(t[27]=e("div",{class:"label"},[i(" Enable Glow Trails? "),e("div",{class:"desc"},"Pens leave glow trails behind?")],-1)),e("div",Ge,[e("label",je,[e("input",{type:"checkbox",checked:o.value.penTrails,onChange:t[11]||(t[11]=l=>Z(l.target.checked))},null,40,qe),t[26]||(t[26]=e("span",{class:"slider"},null,-1))])])]),e("div",We,[t[28]||(t[28]=e("div",{class:"label",for:"showCode"},[i(" Glow Trail Intensity "),e("div",{class:"desc"},"Adjust the scale of the lights")],-1)),e("div",Ze,[e("div",Qe,v(o.value.penTrailsIntensity.toFixed(1)),1),e("input",{id:"penTrailsIntensity",class:"slider",type:"range",min:"0.1",max:"1",step:"0.1",value:o.value.penTrailsIntensity,onInput:t[12]||(t[12]=l=>o.value.penTrailsIntensity=Math.max(.1,Math.min(1,parseFloat(l.target.value)||1)))},null,40,Xe)])]),e("div",Je,[t[29]||(t[29]=e("div",{class:"label",for:"showCode"},[i(" Glow Trail Decay "),e("div",{class:"desc"},[i("How quick will the trails fade?"),e("br"),i("Higher value is longer.")])],-1)),e("div",Ke,[e("div",Ye,v(o.value.penTrailsDecay.toFixed(1)),1),e("input",{id:"penTrailsDecay",class:"slider",type:"range",min:"0.1",max:"1",step:"0.1",value:o.value.penTrailsDecay,onInput:t[13]||(t[13]=l=>o.value.penTrailsDecay=Math.max(.1,Math.min(1,parseFloat(l.target.value)||1)))},null,40,et)])]),u("",!0)]))}},lt=X(tt,[["__scopeId","data-v-734bf1a5"]]);export{lt as R,ot as u};
