import{_ as V,r,w as x,o as S,c as v,b as C,d as e,f as y,e as b,v as E,u as A,i as L,l as D,m as U,k as R,j as k,t as I,h as T}from"./index-CV9c4C8w.js";import{u as j,R as B}from"./RoomForm-Ca5NQOkW.js";const M={class:"room-details-form"},F={class:"row"},G={class:"field"},P={class:"row"},J={class:"field"},q={class:"row row--full"},W={__name:"RoomDetailsForm",props:{data:{type:Object,required:!0,default:()=>({})}},setup(_){const i=_,u=r(""),d=r(""),p=r("");function f(){i.data&&(i.data.code&&(u.value=i.data.code),i.data.editCode&&(d.value=i.data.editCode),i.data.obsLink&&(p.value=i.data.obsLink))}return x(()=>i.data,(l,o)=>{l&&f()}),S(()=>{f()}),(l,o)=>(C(),v("div",M,[e("div",F,[o[3]||(o[3]=e("div",{class:"label",for:"roomCode"},[y(" Room Code "),e("div",{class:"desc"},"Give this code out for people to join!")],-1)),e("div",G,[b(e("input",{id:"roomCode",type:"text","onUpdate:modelValue":o[0]||(o[0]=a=>u.value=a),readonly:""},null,512),[[E,u.value]])])]),e("div",P,[o[4]||(o[4]=e("div",{class:"label",for:"editCode"},[y(" Edit Code "),e("div",{class:"desc"},"Write this down if you wish to edit the room in the future!")],-1)),e("div",J,[b(e("input",{id:"editCode",type:"text","onUpdate:modelValue":o[1]||(o[1]=a=>d.value=a),readonly:""},null,512),[[E,d.value]])])]),e("div",q,[o[5]||(o[5]=y(" OBS Link ",-1)),o[6]||(o[6]=e("div",{class:"desc"},"Load this Link in OBS as a Browser Source!",-1)),b(e("input",{id:"obsLink",type:"text","onUpdate:modelValue":o[2]||(o[2]=a=>p.value=a),readonly:""},null,512),[[E,p.value]])])]))}},z=V(W,[["__scopeId","data-v-69bd7976"]]),H={class:"edit-room-view"},K={key:0,align:"center"},Q={key:1,align:"center"},X={class:"page-title mb-4"},Y={key:2},Z={__name:"EditRoomView",setup(_){const i=A(),u=T(),d=i.params.room_code,{getEditCode:p,saveEditCode:f}=j(),l=L({code:d,editCode:"",obsLink:""}),o=L({name:"a room",password:"",themeColor:"00ABAE",showCode:"bottom-left",penColors:[],penlightSprite:null,duplicateUsers:!0,duplicationThreshold:10,maxConcurrent:100}),a={LOADING:"LOADING",NEEDS_CODE:"NEEDS_CODE",VALID_ROOM:"VALID_ROOM"},c=r(a.LOADING),m=r(null),w=r(""),g="https://api.pen.lighting",h="http://localhost:5173";S(()=>{const n=p(d);if(n){m.value=n,O();return}c.value=a.NEEDS_CODE});async function O(){const n=JSON.stringify({editCode:m.value}),s=await fetch(`${g}/rooms/${d}/edit`,{method:"POST",headers:{"Content-Type":"application/json"},body:n});if(!s.ok)throw new Error(`Create failed (${s.status})`);const t=await s.json();l.code=t.code,l.editCode=t.editCode,l.obsLink=`${h}/obs/${t.code}`,l.pageLink=`${h}/room/${t.code}`,o.name=t.name,o.password=t.password,o.themeColor=t.themeColor,o.showCode=t.showCode,o.penColors=t.penColors,o.penlightSprite=t.penlightSprite,o.duplicateUsers=t.duplicateUsers,o.duplicationThreshold=t.duplicationThreshold,o.maxConcurrent=t.maxConcurrent,c.value=a.VALID_ROOM}async function $(){w.value&&(m.value=w.value,f(d,m.value),O())}async function N(){try{const n=I(R(o));n.editCode=m.value;const s=JSON.stringify(n),t=await fetch(`${g}/rooms/${d}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:s});if(!t.ok)throw new Error(`Create failed (${t.status})`);const oo=await t.json();await u.replace({name:"edit",params:{room_code:d}}),window.location.reload()}catch(n){console.log(n)}finally{}}return(n,s)=>(C(),v("div",H,[c.value===a.LOADING?(C(),v("div",K," Loading... ")):D("",!0),c.value===a.NEEDS_CODE?(C(),v("div",Q,[e("div",X,"Enter Edit Code for Room "+U(R(d)),1),b(e("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=t=>w.value=t),placeholder:"Edit Code",class:"room-code-input mb-4 big-input"},null,512),[[E,w.value]]),s[2]||(s[2]=e("br",null,null,-1)),e("button",{class:"join-button big-button",onClick:$}," Edit Room ")])):D("",!0),c.value===a.VALID_ROOM?(C(),v("div",Y,[s[3]||(s[3]=e("div",{class:"page-title",align:"center"},"Room Details:",-1)),k(z,{data:l,class:"mb-4"},null,8,["data"]),s[4]||(s[4]=e("br",null,null,-1)),s[5]||(s[5]=e("br",null,null,-1)),s[6]||(s[6]=e("div",{class:"page-title",align:"center"},"Edit Room Below:",-1)),k(B,{modelValue:o,"onUpdate:modelValue":s[1]||(s[1]=t=>o=t)},null,8,["modelValue"]),e("div",{class:"update-row"},[e("button",{class:"join-button big-button",onClick:N}," Update / Edit Room ")])])):D("",!0)]))}},so=V(Z,[["__scopeId","data-v-b44a6afa"]]);export{so as default};
