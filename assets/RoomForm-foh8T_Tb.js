import{_ as te,p as $,h as oe,r as u,w as _,c as r,b as d,d as t,f as i,e as y,l as p,v as k,g as D,m as A,q as se,F as le,x as ne,n as ae,y as ie}from"./index-C7mKpxkj.js";function Qe(){function v(s){return`editCode:${s}`}function x(s,g){sessionStorage.setItem(v(s),g)}function S(s){return sessionStorage.getItem(v(s))}function P(s){sessionStorage.removeItem(v(s))}return{saveEditCode:x,getEditCode:S,clearEditCode:P}}const re={class:"room-form"},de={class:"row"},ce={class:"field"},ue={key:0,class:"error"},pe={class:"row"},ve={class:"field"},fe={key:0,class:"error"},me={class:"row"},he={class:"field color-field"},ge={class:"color-wrapper"},Ce={class:"row"},we={class:"field"},be=["value"],_e={class:"row"},ye={class:"field"},ke={class:"swatches"},xe=["title","onClick"],Se={key:0,class:"popover"},Pe={align:"center"},Re={class:"color-wrapper"},Ie={key:1,class:"popover"},Ae={class:"popover-actions"},Me={key:0,class:"error"},Ue={class:"row"},Ne={class:"field sprite-field"},Te={key:0,class:"preview"},Ee=["src"],Ve={class:"sprite-actions"},$e=["disabled"],De={class:"row"},Fe={class:"field switch-field"},Be={class:"switch"},Oe=["checked"],He={class:"row"},Le={class:"field"},qe=["value"],We={class:"row"},Ze={class:"field"},Ge=["value"],je={__name:"RoomForm",props:{modelValue:{type:Object,required:!0},mode:{type:String,default:"edit"}},emits:["update:modelValue"],setup(v,{emit:x}){const S=v,P=x,s=$({get(){return S.modelValue},set(o){P("update:modelValue",o)}}),g=/^#[0-9A-Fa-f]{6}$/,F=/^[0-9a-zA-Z,.! ]+$/,B=/^[0-9A-Za-z ,.!\-_=+@#$%^&*(){}\[\]|\\:;"'<>,.?/~`]+$/;function M(o){return o===""||typeof o=="string"&&o.length<=64&&F.test(o)}function U(o){return o===""||typeof o=="string"&&o.length<=64&&B.test(o)}const a=oe({name:"",password:"",penColors:""}),f=u(s.value.name??""),m=u(s.value.password??"");_(()=>s.value.name,o=>{o!==f.value&&M(o??"")&&(f.value=o??"")}),_(()=>s.value.password,o=>{o!==m.value&&U(o??"")&&(m.value=o??"")}),_(f,o=>{M(o)?(a.name="",s.value.name=o):a.name="Only 0-9 a-z A-Z , . ! and space; max 64 chars"}),_(m,o=>{U(o)?(a.password="",s.value.password=o):a.password="Invalid characters or length > 64"});const N=$({get(){const o=s.value.themeColor||"";return o?`#${o}`:"#000000"},set(o){const e=(o||"").trim();g.test(e)&&(s.value.themeColor=e.slice(1).toUpperCase())}});function O(o){["hidden","top-left","top-right","bottom-left","bottom-right"].includes(o)&&(s.value.showCode=o)}const C=u(!1),R=u(null),c=u(-1),w=u("#000000");function H(){c.value=-1,w.value="#000000",C.value=!0,ae(()=>R.value&&R.value.focus())}function L(){const o=w.value;if(g.test(o)){const e=o.slice(1).toUpperCase();s.value.penColors.includes(e)||s.value.penColors.push(e),a.penColors=""}else a.penColors="Pick a 6-digit hex color";C.value=!1}function q(){C.value=!1}function W(o){c.value=c.value===o?-1:o}function Z(o){s.value.penColors.splice(o,1),c.value=-1}const I=u(null);async function G(o){const e=o.target.files&&o.target.files[0];if(!e||e.type!=="image/png")return;const l=await z(e),n=await Q(l,256);n&&(s.value.penlightSprite=n)}function j(){s.value.penlightSprite=null,I.value&&(I.value.value="")}function z(o){return new Promise((e,l)=>{const n=new FileReader;n.onload=()=>e(n.result),n.onerror=l,n.readAsDataURL(o)})}function Q(o,e=256){return new Promise(l=>{const n=new Image;n.onload=()=>{const h=document.createElement("canvas");h.width=e,h.height=e;const b=h.getContext("2d");b.clearRect(0,0,e,e);const T=Math.min(e/n.width,e/n.height),E=Math.round(n.width*T),V=Math.round(n.height*T),Y=Math.floor((e-E)/2),ee=Math.floor((e-V)/2);b.imageSmoothingEnabled=!0,b.imageSmoothingQuality="high",b.drawImage(n,Y,ee,E,V),l(h.toDataURL("image/png"))},n.onerror=()=>l(null),n.src=o})}function X(o){s.value.duplicateUsers=!!o}function J(o){const e=Number(o);if(Number.isFinite(e)){const l=Math.max(1,Math.min(100,Math.trunc(e)));s.value.duplicationThreshold=l}}function K(o){const e=Number(o);Number.isFinite(e)&&(s.value.maxConcurrent=Math.max(1,Math.trunc(e)))}return(o,e)=>(d(),r("div",re,[t("div",de,[e[11]||(e[11]=t("div",{class:"label",for:"name"},[i(" Name "),t("div",{class:"desc"},"(optional)")],-1)),t("div",ce,[y(t("input",{id:"name",type:"text",maxlength:64,"onUpdate:modelValue":e[0]||(e[0]=l=>f.value=l),placeholder:"(optional)",class:D({invalid:!!a.name})},null,2),[[k,f.value]]),a.name?(d(),r("p",ue,A(a.name),1)):p("",!0)])]),t("div",pe,[e[12]||(e[12]=t("div",{class:"label",for:"password"},[i(" Password "),t("div",{class:"desc"},"optional - to make private room")],-1)),t("div",ve,[y(t("input",{id:"password",type:"text",maxlength:64,"onUpdate:modelValue":e[1]||(e[1]=l=>m.value=l),placeholder:"(optional)",class:D({invalid:!!a.password})},null,2),[[k,m.value]]),a.password?(d(),r("p",fe,A(a.password),1)):p("",!0)])]),t("div",me,[e[13]||(e[13]=t("div",{class:"label",for:"themeColor"},[i(" Theme Color "),t("div",{class:"desc"},"Used for name text & Code text")],-1)),t("div",he,[t("div",ge,[y(t("input",{id:"themeColor",type:"color","onUpdate:modelValue":e[2]||(e[2]=l=>N.value=l),"aria-label":"Pick a theme color"},null,512),[[k,N.value]])]),p("",!0)])]),t("div",Ce,[e[15]||(e[15]=t("div",{class:"label",for:"showCode"},[i(" Show Code "),t("div",{class:"desc"},"Where to show the Code in the OBS source")],-1)),t("div",we,[t("select",{id:"showCode",value:s.value.showCode,onChange:e[3]||(e[3]=l=>O(l.target.value))},[...e[14]||(e[14]=[se('<option value="hidden" data-v-0c30fcc6>Hidden</option><option value="top-left" data-v-0c30fcc6>Top Left</option><option value="top-right" data-v-0c30fcc6>Top Right</option><option value="bottom-left" data-v-0c30fcc6>Bottom Left</option><option value="bottom-right" data-v-0c30fcc6>Bottom Right</option>',5)])],40,be)])]),t("div",_e,[e[16]||(e[16]=t("div",{class:"label"},[i(" Pen Colors "),t("div",{class:"desc"},"Add colors for chatters to pick for their pen."),t("div",{class:"desc"},"Or, leave empty and theme color will be used.")],-1)),t("div",ye,[t("div",ke,[(d(!0),r(le,null,ne(s.value.penColors,(l,n)=>(d(),r("button",{key:n,type:"button",class:"swatch",style:ie({backgroundColor:"#"+l}),title:"#"+l,onClick:h=>W(n)},null,12,xe))),128)),t("button",{type:"button",class:"add",onClick:H,title:"Add color"},"+"),C.value?(d(),r("div",Se,[t("div",Pe,[t("div",Re,[y(t("input",{ref_key:"addPickerRef",ref:R,type:"color","onUpdate:modelValue":e[4]||(e[4]=l=>w.value=l)},null,512),[[k,w.value]])])]),t("div",{class:"popover-actions"},[t("button",{type:"button",onClick:L},"Confirm"),t("button",{type:"button",class:"ghost",onClick:q},"Cancel")])])):p("",!0),c.value>=0?(d(),r("div",Ie,[t("div",Ae,[t("button",{type:"button",class:"danger",onClick:e[5]||(e[5]=l=>Z(c.value))},"Delete"),t("button",{type:"button",class:"ghost",onClick:e[6]||(e[6]=l=>c.value=-1)},"Close")])])):p("",!0)]),a.penColors?(d(),r("p",Me,A(a.penColors),1)):p("",!0)])]),t("div",Ue,[e[17]||(e[17]=t("div",{class:"label"},[i(" Penlight Sprite "),t("div",{class:"desc"},[i(" Optional PNG to show as base penlight in OBS. "),t("br"),i(" Will be resized to 256Ã—256. ")])],-1)),t("div",Ne,[s.value.penlightSprite?(d(),r("div",Te,[t("img",{src:s.value.penlightSprite,alt:"Sprite preview"},null,8,Ee)])):p("",!0),t("div",Ve,[t("input",{id:"sprite-file-input",ref_key:"fileInputRef",ref:I,type:"file",accept:"image/png",class:"file-input sr-only",onChange:G,"aria-label":"Choose a PNG sprite"},null,544),t("button",{type:"button",class:"btn btn-primary",onClick:e[7]||(e[7]=l=>o.$refs.fileInputRef&&o.$refs.fileInputRef.click())}," Choose File "),t("button",{type:"button",class:"btn btn-ghost",disabled:!s.value.penlightSprite,onClick:j}," Clear Image ",8,$e)])])]),t("div",De,[e[19]||(e[19]=t("div",{class:"label"},[i(" Duplicate Users? "),t("div",{class:"desc"},"Show users more than once to fill space?")],-1)),t("div",Fe,[t("label",Be,[t("input",{type:"checkbox",checked:s.value.duplicateUsers,onChange:e[8]||(e[8]=l=>X(l.target.checked))},null,40,Oe),e[18]||(e[18]=t("span",{class:"slider"},null,-1))])])]),t("div",He,[e[20]||(e[20]=t("div",{class:"label",for:"dupThresh"},[i(" Dupe Threshold "),t("div",{class:"desc"},"Cut off to stop duplication")],-1)),t("div",Le,[t("input",{id:"dupThresh",type:"number",min:"1",max:"100",value:s.value.duplicationThreshold,onInput:e[9]||(e[9]=l=>J(l.target.value))},null,40,qe)])]),t("div",We,[e[21]||(e[21]=t("div",{class:"label",for:"maxConc"},[i(" Max Concurrent "),t("div",{class:"desc"},"How many to render in OBS")],-1)),t("div",Ze,[t("input",{id:"maxConc",type:"number",min:"1",value:s.value.maxConcurrent,onInput:e[10]||(e[10]=l=>K(l.target.value))},null,40,Ge)])])]))}},Xe=te(je,[["__scopeId","data-v-0c30fcc6"]]);export{Xe as R,Qe as u};
