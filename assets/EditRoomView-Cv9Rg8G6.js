import{_ as k,r,w as x,o as L,c as v,b as C,d as t,f as g,e as b,v as E,k as A,h as _,l as y,m as T,j as O,i as R,t as $,u as I}from"./index-RybedRza.js";import{u as U,R as j}from"./RoomForm-DEouCowS.js";const B={class:"room-details-form"},M={class:"row"},F={class:"field"},G={class:"row"},P={class:"field"},J={class:"row row--full"},q={__name:"RoomDetailsForm",props:{data:{type:Object,required:!0,default:()=>({})}},setup(D){const i=D,u=r(""),d=r(""),p=r("");function f(){i.data&&(i.data.code&&(u.value=i.data.code),i.data.editCode&&(d.value=i.data.editCode),i.data.obsLink&&(p.value=i.data.obsLink))}return x(()=>i.data,(l,o)=>{l&&f()}),L(()=>{f()}),(l,o)=>(C(),v("div",B,[t("div",M,[o[3]||(o[3]=t("div",{class:"label",for:"roomCode"},[g(" Room Code "),t("div",{class:"desc"},"Give this code out for people to join!")],-1)),t("div",F,[b(t("input",{id:"roomCode",type:"text","onUpdate:modelValue":o[0]||(o[0]=a=>u.value=a),readonly:""},null,512),[[E,u.value]])])]),t("div",G,[o[4]||(o[4]=t("div",{class:"label",for:"editCode"},[g(" Edit Code "),t("div",{class:"desc"},"Write this down if you wish to edit the room in the future!")],-1)),t("div",P,[b(t("input",{id:"editCode",type:"text","onUpdate:modelValue":o[1]||(o[1]=a=>d.value=a),readonly:""},null,512),[[E,d.value]])])]),t("div",J,[o[5]||(o[5]=g(" OBS Link ",-1)),o[6]||(o[6]=t("div",{class:"desc"},"Load this Link in OBS as a Browser Source!",-1)),b(t("input",{id:"obsLink",type:"text","onUpdate:modelValue":o[2]||(o[2]=a=>p.value=a),readonly:""},null,512),[[E,p.value]])])]))}},W=k(q,[["__scopeId","data-v-69bd7976"]]),z={class:"edit-room-view"},H={key:0,align:"center"},K={key:1,align:"center"},Q={class:"page-title mb-4"},X={key:2},Y={__name:"EditRoomView",setup(D){const i=A(),u=I(),d=i.params.room_code,{getEditCode:p,saveEditCode:f}=U(),l=_({code:d,editCode:"",obsLink:""}),o=_({name:"a room",password:"",themeColor:"00ABAE",showCode:"bottom-left",penColors:[],penlightSprite:null,duplicateUsers:!0,duplicationThreshold:10,maxConcurrent:100}),a={LOADING:"LOADING",NEEDS_CODE:"NEEDS_CODE",VALID_ROOM:"VALID_ROOM"},c=r(a.LOADING),m=r(null),w=r("");L(()=>{const n=p(d);if(n){m.value=n,h();return}c.value=a.NEEDS_CODE});async function h(){const n=JSON.stringify({editCode:m.value}),e=await fetch(`https://api.pen.lighting/rooms/${d}/edit`,{method:"POST",headers:{"Content-Type":"application/json"},body:n});if(!e.ok)throw new Error(`Create failed (${e.status})`);const s=await e.json();l.code=s.code,l.editCode=s.editCode,l.obsLink=`https://pen.lighting/obs/${s.code}`,o.name=s.name,o.password=s.password,o.themeColor=s.themeColor,o.showCode=s.showCode,o.penColors=s.penColors,o.penlightSprite=s.penlightSprite,o.duplicateUsers=s.duplicateUsers,o.duplicationThreshold=s.duplicationThreshold,o.maxConcurrent=s.maxConcurrent,c.value=a.VALID_ROOM}async function V(){w.value&&(m.value=w.value,f(d,m.value),h())}async function S(){try{const n=$(O(o));n.editCode=m.value;const e=JSON.stringify(n),s=await fetch(`https://api.pen.lighting/rooms/${d}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:e});if(!s.ok)throw new Error(`Create failed (${s.status})`);const N=await s.json();console.log(N),await u.replace({name:"edit",params:{room_code:d}}),window.location.reload()}catch(n){console.log(n)}finally{}}return(n,e)=>(C(),v("div",z,[c.value===a.LOADING?(C(),v("div",H," Loading... ")):y("",!0),c.value===a.NEEDS_CODE?(C(),v("div",K,[t("div",Q,"Enter Edit Code for Room "+T(O(d)),1),b(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=s=>w.value=s),placeholder:"Edit Code",class:"room-code-input mb-4 big-input"},null,512),[[E,w.value]]),e[2]||(e[2]=t("br",null,null,-1)),t("button",{class:"join-button big-button",onClick:V}," Edit Room ")])):y("",!0),c.value===a.VALID_ROOM?(C(),v("div",X,[e[3]||(e[3]=t("div",{class:"page-title",align:"center"},"Room Details:",-1)),R(W,{data:l,class:"mb-4"},null,8,["data"]),e[4]||(e[4]=t("br",null,null,-1)),e[5]||(e[5]=t("br",null,null,-1)),e[6]||(e[6]=t("div",{class:"page-title",align:"center"},"Edit Room Below:",-1)),R(j,{modelValue:o,"onUpdate:modelValue":e[1]||(e[1]=s=>o=s)},null,8,["modelValue"]),t("div",{class:"update-row"},[t("button",{class:"join-button big-button",onClick:S}," Update / Edit Room ")])])):y("",!0)]))}},to=k(Y,[["__scopeId","data-v-5ec435ff"]]);export{to as default};
