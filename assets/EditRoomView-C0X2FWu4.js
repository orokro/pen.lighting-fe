import{_ as T,r as u,w as $,o as V,c as C,b as f,d as t,f as b,e as w,v as y,u as I,i as g,l as D,m as x,k as O,j as _,t as N,h as U}from"./index-BtlqQoGs.js";import{u as j,R as B}from"./RoomForm-B1R3uZm8.js";const G={class:"room-details-form"},M={class:"row"},F={class:"field"},P={class:"row"},J={class:"field"},q={class:"row row--full"},W={class:"row row--full"},z={__name:"RoomDetailsForm",props:{data:{type:Object,required:!0,default:()=>({})}},setup(E){const i=E,p=u(""),l=u(""),c=u(""),m=u("");function r(){i.data&&(i.data.code&&(p.value=i.data.code),i.data.editCode&&(l.value=i.data.editCode),i.data.obsLink&&(c.value=i.data.obsLink),i.data.shareLink&&(m.value=i.data.shareLink))}return $(()=>i.data,(s,e)=>{s&&r()}),V(()=>{r()}),(s,e)=>(f(),C("div",G,[e[10]||(e[10]=t("div",{class:"row-header"},"OBS Integration & Sharing Details",-1)),t("div",M,[e[4]||(e[4]=t("div",{class:"label",for:"roomCode"},[b(" Room Code "),t("div",{class:"desc"},"Give this code out for people to join!")],-1)),t("div",F,[w(t("input",{id:"roomCode",type:"text","onUpdate:modelValue":e[0]||(e[0]=n=>p.value=n),readonly:""},null,512),[[y,p.value]])])]),t("div",P,[e[5]||(e[5]=t("div",{class:"label",for:"editCode"},[b(" Edit Code "),t("div",{class:"desc"},"Write this down if you wish to edit the room in the future!")],-1)),t("div",J,[w(t("input",{id:"editCode",type:"text","onUpdate:modelValue":e[1]||(e[1]=n=>l.value=n),readonly:""},null,512),[[y,l.value]])])]),t("div",q,[e[6]||(e[6]=b(" OBS Link ",-1)),e[7]||(e[7]=t("div",{class:"desc"},"Load this Link in OBS as a Browser Source!",-1)),w(t("input",{id:"obsLink",type:"text","onUpdate:modelValue":e[2]||(e[2]=n=>c.value=n),readonly:""},null,512),[[y,c.value]])]),t("div",W,[e[8]||(e[8]=b(" Share Link ",-1)),e[9]||(e[9]=t("div",{class:"desc"},"Give this link to chat! (e.g. pinned message)",-1)),w(t("input",{id:"shareLink",type:"text","onUpdate:modelValue":e[3]||(e[3]=n=>m.value=n),readonly:""},null,512),[[y,m.value]])])]))}},H=T(z,[["__scopeId","data-v-8c68d21a"]]),K={class:"edit-room-view"},Q={key:0,align:"center"},X={key:1,align:"center"},Y={class:"page-title mb-4"},Z={key:2},ee={__name:"EditRoomView",setup(E){const i=I(),p=U(),l=i.params.room_code,{getEditCode:c,saveEditCode:m}=j(),r=g({code:l,editCode:"",obsLink:"",shareLink:""}),s=g({name:"",password:"",themeColor:"00ABAE",showCode:"bottom-left",showCodeScale:1,maxConcurrent:100,penColors:[],allowAnyColor:!1,penlightSprite:null,penScale:1,penTrails:!0,penTrailsIntensity:.5,penTrailsDecay:.8,duplicateUsers:!1,duplicationThreshold:10}),e={LOADING:"LOADING",NEEDS_CODE:"NEEDS_CODE",VALID_ROOM:"VALID_ROOM"},n=u(e.LOADING),v=u(null),h=u(""),k="https://api.pen.lighting",L="https://pen.lighting";V(()=>{const d=c(l);if(d){v.value=d,S();return}n.value=e.NEEDS_CODE});async function S(){const d=JSON.stringify({editCode:v.value}),a=await fetch(`${k}/rooms/${l}/edit`,{method:"POST",headers:{"Content-Type":"application/json"},body:d});if(!a.ok)throw new Error(`Create failed (${a.status})`);const o=await a.json();r.code=o.code,r.editCode=o.editCode,r.obsLink=`${L}/obs/${o.code}`,r.shareLink=`${L}/room/${o.code}`,s.name=o.name,s.password=o.password,s.themeColor=o.themeColor,s.showCode=o.showCode,s.showCodeScale=o.showCodeScale,s.maxConcurrent=o.maxConcurrent,s.penColors=o.penColors,s.allowAnyColor=o.allowAnyColor,s.penlightSprite=o.penlightSprite,s.penScale=o.penScale,s.penTrails=o.penTrails,s.penTrailsIntensity=o.penTrailsIntensity,s.penTrailsDecay=o.penTrailsDecay,s.duplicateUsers=o.duplicateUsers,s.duplicationThreshold=o.duplicationThreshold,n.value=e.VALID_ROOM}async function R(){h.value&&(v.value=h.value,m(l,v.value),S())}async function A(){try{const d=N(O(s));d.editCode=v.value;const a=JSON.stringify(d),o=await fetch(`${k}/rooms/${l}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:a});if(!o.ok)throw new Error(`Create failed (${o.status})`);const oe=await o.json();await p.replace({name:"edit",params:{room_code:l}}),window.location.reload()}catch(d){console.log(d)}finally{}}return(d,a)=>(f(),C("div",K,[n.value===e.LOADING?(f(),C("div",Q," Loading... ")):D("",!0),n.value===e.NEEDS_CODE?(f(),C("div",X,[t("div",Y,"Enter Edit Code for Room "+x(O(l)),1),w(t("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=o=>h.value=o),placeholder:"Edit Code",class:"room-code-input mb-4 big-input"},null,512),[[y,h.value]]),a[2]||(a[2]=t("br",null,null,-1)),t("button",{class:"join-button big-button",onClick:R}," Edit Room ")])):D("",!0),n.value===e.VALID_ROOM?(f(),C("div",Z,[_(H,{data:r,class:"mb-4"},null,8,["data"]),a[3]||(a[3]=t("br",null,null,-1)),a[4]||(a[4]=t("br",null,null,-1)),_(B,{modelValue:s,"onUpdate:modelValue":a[1]||(a[1]=o=>s=o)},null,8,["modelValue"]),t("div",{class:"update-row"},[t("button",{class:"join-button big-button",onClick:A}," Update / Edit Room ")])])):D("",!0)]))}},ae=T(ee,[["__scopeId","data-v-f575e41a"]]);export{ae as default};
